library(readxl)

F319=read.csv("F-319.csv",header=TRUE)
F45=read.csv("F-45.csv",header=TRUE)
F179=read.csv("F-179.csv",header=TRUE)
G561_T=read.csv("G-561_T.csv",header=TRUE)
G580A=read.csv("G-580A.csv",header=TRUE)
G852=read.csv("G-852.csv",header=TRUE)
G860=read.csv("G-860.csv",header=TRUE)
G1220_T=read.csv("G-1220_T.csv",header=TRUE)
G1260_T=read.csv("G-1260_T.csv",header=TRUE)
G2147_T=read.csv("G-2147_T.csv",header=TRUE)
G2866_T=read.csv("G-2866_T.csv",header=TRUE)
G3549=read.csv("G-3549.csv",header=TRUE)
PB1680_T=read.csv("PB-1680_T.csv",header=TRUE)


F319$startdate <- strptime(F319$date, "%m/%d/%y")
F319$starttime <- strptime(F319$time, "%H:%M")
F319$starttime = format(F319$starttime, "%H:%M:%S")
F319$datetime <- paste(F319$startdate,F319$starttime,F319$tz_cd)
F319 <- aggregate(F319["Corrected"], list(hour=cut(as.POSIXct(F319$datetime), "month")), mean)

F45$startdate <- strptime(F45$date, "%m/%d/%y")
F45$starttime <- strptime(F45$time, "%H:%M")
F45$starttime = format(F45$starttime, "%H:%M:%S")
F45$datetime <- paste(F45$startdate,F45$starttime,F45$tz_cd)
F45 <- aggregate(F45["Corrected"], list(hour=cut(as.POSIXct(F45$datetime), "month")), mean)

F179$startdate <- strptime(F179$date, "%m/%d/%y")
F179$starttime <- strptime(F179$time, "%H:%M")
F179$starttime = format(F179$starttime, "%H:%M:%S")
F179$datetime <- paste(F179$startdate,F179$starttime,F179$tz_cd)
F179 <- aggregate(F179["Corrected"], list(hour=cut(as.POSIXct(F179$datetime), "month")), mean)

G561_T$startdate <- strptime(G561_T$date, "%m/%d/%y")
G561_T$starttime <- strptime(G561_T$time, "%H:%M")
G561_T$starttime = format(G561_T$starttime, "%H:%M:%S")
G561_T$datetime <- paste(G561_T$startdate,G561_T$starttime,G561_T$tz_cd)
G561_T <- aggregate(G561_T["Corrected"], list(hour=cut(as.POSIXct(G561_T$datetime), "month")), mean)

G580A$startdate <- strptime(G580A$date, "%m/%d/%y")
G580A$starttime <- strptime(G580A$time, "%H:%M")
G580A$starttime = format(G580A$starttime, "%H:%M:%S")
G580A$datetime <- paste(G580A$startdate,G580A$starttime,G580A$tz_cd)
G580A <- aggregate(G580A["Corrected"], list(hour=cut(as.POSIXct(G580A$datetime), "month")), mean)

G852 = G852[32:97221,]
G852$startdate <- strptime(G852$date, "%m/%d/%y")
G852$starttime <- strptime(G852$time, "%H:%M")
G852$starttime = format(G852$starttime, "%H:%M:%S")
G852$datetime <- paste(G852$startdate,G852$starttime,G852$tz_cd)
G852 <- aggregate(G852["Corrected"], list(hour=cut(as.POSIXct(G852$datetime), "month")), mean)

G860$startdate <- strptime(G860$date, "%m/%d/%y")
G860$starttime <- strptime(G860$time, "%H:%M")
G860$starttime = format(G860$starttime, "%H:%M:%S")
G860$datetime <- paste(G860$startdate,G860$starttime,G860$tz_cd)
G860 <- aggregate(G860["Corrected"], list(hour=cut(as.POSIXct(G860$datetime), "month")), mean)

G1220_T$startdate <- strptime(G1220_T$date, "%m/%d/%y")
G1220_T$starttime <- strptime(G1220_T$time, "%H:%M")
G1220_T$starttime = format(G1220_T$starttime, "%H:%M:%S")
G1220_T$datetime <- paste(G1220_T$startdate,G1220_T$starttime,G1220_T$tz_cd)
G1220_T <- aggregate(G1220_T["Corrected"], list(hour=cut(as.POSIXct(G1220_T$datetime), "month")), mean)

G1260_T$startdate <- strptime(G1260_T$date, "%m/%d/%y")
G1260_T$starttime <- strptime(G1260_T$time, "%H:%M")
G1260_T$starttime = format(G1260_T$starttime, "%H:%M:%S")
G1260_T$datetime <- paste(G1260_T$startdate,G1260_T$starttime,G1260_T$tz_cd)
G1260_T <- aggregate(G1260_T["Corrected"], list(hour=cut(as.POSIXct(G1260_T$datetime), "month")), mean)

G2147_T$startdate <- strptime(G2147_T$date, "%m/%d/%y")
G2147_T$starttime <- strptime(G2147_T$time, "%H:%M")
G2147_T$starttime = format(G2147_T$starttime, "%H:%M:%S")
G2147_T$datetime <- paste(G2147_T$startdate,G2147_T$starttime,G2147_T$tz_cd)
G2147_T <- aggregate(G2147_T["Corrected"], list(hour=cut(as.POSIXct(G2147_T$datetime), "month")), mean)

G2866_T$startdate <- strptime(G2866_T$date, "%m/%d/%y")
G2866_T$starttime <- strptime(G2866_T$time, "%H:%M")
G2866_T$starttime = format(G2866_T$starttime, "%H:%M:%S")
G2866_T$datetime <- paste(G2866_T$startdate,G2866_T$starttime,G2866_T$tz_cd)
G2866_T <- aggregate(G2866_T["Corrected"], list(hour=cut(as.POSIXct(G2866_T$datetime), "month")), mean)

G3549$startdate <- strptime(G3549$date, "%m/%d/%y")
G3549$starttime <- strptime(G3549$time, "%H:%M")
G3549$starttime = format(G3549$starttime, "%H:%M:%S")
G3549$datetime <- paste(G3549$startdate,G3549$starttime,G3549$tz_cd)
G3549 <- aggregate(G3549["Corrected"], list(hour=cut(as.POSIXct(G3549$datetime), "month")), mean)

PB1680_T$startdate <- strptime(PB1680_T$date, "%m/%d/%y")
PB1680_T$starttime <- strptime(PB1680_T$time, "%H:%M")
PB1680_T$starttime = format(PB1680_T$starttime, "%H:%M:%S")
PB1680_T$datetime <- paste(PB1680_T$startdate,PB1680_T$starttime,PB1680_T$tz_cd)
PB1680_T <- aggregate(PB1680_T["Corrected"], list(hour=cut(as.POSIXct(PB1680_T$datetime), "month")), mean)

write.csv(F319, file = "F319.csv")
write.csv(F45, file = "F45.csv")
write.csv(F179, file = "F179.csv")
write.csv(G561_T, file = "G561_T.csv")
write.csv(G580A, file = "G580A.csv")
#write.csv(G852, file = "G852.csv")
write.csv(G860, file = "G860.csv")
write.csv(G1220_T, file = "G1220_T.csv")
write.csv(G1260_T, file = "G1260_T.csv")
write.csv(G2147_T, file = "G2147_T.csv")
write.csv(G2866_T, file = "G2866_T.csv")
write.csv(G3549, file = "G3549.csv")
write.csv(PB1680_T, file = "PB1680_T.csv")
